<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Why and How Testing Can Make You Happier</title>
  <meta name="description" content="I was once a non-tester, because I didn‚Äôt see the value. Then I tried it for a while, and was convinced. I‚Äôve gathered some experience, but not enough. This ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="canonical" href="http://mikbe.com/code/testing/dx/2016/03/11/why-and-how-testing-can-make-you-happier.html">
  <link rel="alternate" type="application/rss+xml" title="Mikbe.com" href="http://mikbe.com/feed.xml">
</head>


  <body>

    
      <div class="transparent">
        <section class="hero is-info is-left is-bold">
  <div class="hero-header">
    <header class="header">

      <!-- Left side -->
      <div class="header-left">
        <div class="header-item">
          <a class="header-item" href="/">
            <h1 class="title">Mikbe.com</h1>
          </a>
        </div>
      </div>

      <!-- Right side -->
      <div class="header-right">
        
          
        
          
        
          
        
      </div>

    </heaer>
  </div>
</section>

      </div>
      <div class="heroimg">
        

<img src="/images/ninjastyle.jpg" srcset="            /images/resized/400/ninjastyle.jpg 400w,            /images/resized/800/ninjastyle.jpg 800w,            /images/resized/1200/ninjastyle.jpg 1200w,            /images/resized/2000/ninjastyle.jpg 2000w,     /images/ninjastyle.jpg 4898w">

      </div>
    

    <section class="section">
      <div class="container">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

          <header class="heading">
            <h1 class="title" itemprop="name headline">Why and How Testing Can Make You Happier</h1>
            <p class="post-meta"><time datetime="2016-03-11T17:32:00+00:00" itemprop="datePublished">Mar 11, 2016</time></p>
          </header>

          <div class="content" itemprop="articleBody">
            <p>I was once a non-tester, because I didn‚Äôt see the value. Then I tried it for a while, and was convinced. I‚Äôve gathered some experience, but not enough. This article is an attempt to collect what I know and what I think I know, and hope I can finally learn some of the stuff I know but don‚Äôt necessarily practice.</p>

<p><img src="/images/simpsons-testing.gif" alt="hello" /></p>

<p>The main inspiration source for this article is <a href="http://javascriptair.com/episodes/2016-01-06/">JavaScript Air episode 004</a>, but there‚Äôs also some original content in here. And some from <a href="https://vimeo.com/68375232">TDD: Where did it all go wrong?</a>.</p>

<blockquote>
  <p>I don‚Äôt always test my code, but when I do, it feels better.</p>

  <p>‚Äì <cite>me</cite></p>
</blockquote>

<h2 id="what-is-it-all-about">What is it all about?</h2>

<p>This, only for code:</p>

<p><img src="/images/testing-bicycle-integration-test.gif" alt="Integration testing a bike" /> <em>The concept isn‚Äôt that hard.</em></p>

<p>This article is mostly about unit testing, as opposed to integration testing or end-to-end testing, but some aspects are true for all kinds. And know that there‚Äôs a spectrum. In practice, tests are seldom one or the other, and that isn‚Äôt the goal either.</p>

<p>Unit tests are cheap and should make up the largest part of your testing efforts. They‚Äôre cheap to write and run. They look at only specific parts of the code. Integration tests are the opposite, they encompass larger parts of the code. Some mimic users.</p>

<h2 id="why-is-it-important">Why is it Important?</h2>

<p>Testing helps you achieve peace of mind about your code. Writing a solution to a half-complex problem, then manually testing it only takes you so far. With some experience, you‚Äôll surely recognize the situation of shipping some code with confidence, only to find it break apart at its first opportunity.</p>

<p>Testing gives experience with the mindset of putting your code under the most extreme conditions it can get into. What if the number passed in was negative when we always assumed it would be positive? What if it wasn‚Äôt a number at all?</p>

<blockquote>
  <p><em>Everybody writes bugs, we all write bugs. So, it‚Äôs not a matter of ‚Äúcan you write code correctly or not the first time?‚Äù, we all write incorrect code. <strong>That‚Äôs all that we do, we only write incorrect code</strong>.</em></p>

  <p>‚Äì <cite>Joe Eames, JavaScript Air 004</cite></p>
</blockquote>

<p><strong>Coding is hard</strong>, and we should all acknowledge that. Among the primary reasons to test your code is to gain confidence that it will behave as <em>expected</em>, whatever that is.</p>

<p>Not convinced? Here are some additional arguments:</p>

<h3 id="tested-code-is-better-code">Tested Code is Better Code</h3>

<p>Many people<sup>[who?]</sup> will tell you that code testing leads to better code quality. This is especially true when using unit tests and at least some variation on test driven development, even if it‚Äôs a sloppy one. Here‚Äôs why:</p>

<p><strong>If your code is hard to test, then it‚Äôs probably not very well written.</strong> What identifies good code is a large question, but the emphasized sentence here is a good rule of thumb. A quality of good code that most will agree on is that it separates concerns. Experienced programmers limit function bodies to only do one logical thing for this reason.</p>

<h4 id="aligning-your-goals">Aligning Your Goals</h4>

<p>Code that is hard to test probably has either too many things going on, or too many dependencies (or both). Think of this as a problem of aligning interests: When writing untested code, there is a conflict of interest between speed (or laziness) and separation of concerns, and it doesn‚Äôt matter as much for the short term how your code is structured. <strong>When your code has to be tested, your goals are more aligned,</strong> because tests are easier to write for well written code!</p>

<h4 id="think-as-a-consumer">Think as a Consumer</h4>

<p>When you‚Äôre writing tests first, you‚Äôre <strong>designing your code‚Äôs API first.</strong> Testing puts you into code consumer mode, where you‚Äôll write code against what‚Äôs going to be the interface to other stuff. Designing your API without so much concern for inner workings leads to a better API design, which leads to easier consumption of your module, which leads to cleaner code in the project as a whole.</p>

<h4 id="eureka-moments">Eureka moments</h4>

<p><strong>Testing leads to a-ha moments.</strong> Often because it forces you to think about edge cases ‚Äì the value zero, <code class="highlighter-rouge">10^12</code>, <code class="highlighter-rouge">null</code> or <code class="highlighter-rouge">undefined</code>. You‚Äôll have the opportunity to think about, reflect on and acknowledge what should happen under strange circumstances. Merely the process of thinking about them, or other situations your code can face, often leads to realizations of how the code can be <em>simplified</em> (as well as how it has to guard itself).</p>

<p>These eureka moments can also come from one of the most frustrating situations: when your code and tests don‚Äôt agree. You‚Äôre put in the situation of having to decide which is right. If you‚Äôre in this situation, something has probably gone wrong with the design, or your assumptions have changed. Think of this as a good sign! Your code will be happier.</p>

<!-- As a side note, I like to think about this situation like an NP-complete problem, *[The travelling salesman problem][travellingsalesman]*. These problem instances basically cannot be calculated without checking all possible solutions, so it's very hard. However, if you have God-given correct answer to the instance, testing the outcome of the algorithm is easy as `t.equal(outcome, godGiven)`. Doesn't it make sense that testing is easier than writing actual code?-->

<h3 id="tests-document-what-the-code-does">Tests Document What the Code Does</h3>

<p>No-one loves to write documentation, but it sure as hell is nice when the module your inheriting (from your one year younger self, or someone else) or interfacing is well documented. Tests can be this documentation, and with an added bonus: tests put their money where their mouths are and <em>demonstrate</em> what they mean. Like the best science teachers, they don‚Äôt just tell you that hydrogen is flammable. They fill a balloon with hydrogen, let it rise to the ceiling and put a lighted match on a stick to it (One of my most memorable 5th grade classes).</p>

<p>Do you know what is common to all bugs? <em>They passed all the tests.</em> So when you find one, you know where not to look.</p>

<p><img src="/images/testing-just-as-i-expected.gif" alt="hello" /> <em>At least you know what doesn‚Äôt work.</em></p>

<p><strong>Testing makes it easier to join a project</strong>, because they reveal what the code is actually supposed to do. They tell a story about the design decisions, what went through the mind of the original developer.</p>

<h3 id="refactor-without-worry">Refactor Without Worry</h3>

<p>Ever looked at a horrible mess of code, but been to afraid to clean it up? The first thing I do in situations like that is to create tests to discover what the code is supposed to be doing. The tests lock down the functionality, in a good way, allowing us to focus on the spring cleaning, rather than worrying about breaking stuff.</p>

<p>I‚Äôve seen pieces of code so bad they cause real concerns of whether they actually do what they‚Äôre supposed to. Still, no-one dared touch it, afraid of not only breaking intended functionality, but also breaking <em>bugs</em>. I suspect a large test set based on past I/O would be well worth its investment.</p>

<p>Fun fact, <strong>the feelings of worry and happiness are inversely proportional</strong>. Or something like that.</p>

<h3 id="create-value-with-confidence-and-correct-products">Create Value with Confidence and Correct Products</h3>

<p>Correct code is more valuable than incorrect code<sup>[citation needed]</sup>. Everything helping your code to be correcter tahn what was there before is worth taking a look at, it‚Äôs as simple as that. Delivering correct code builds up trust over time, trust is a valuable asset.</p>

<h2 id="a-tool-to-use-less-brain-ram">A Tool to Use Less Brain RAM</h2>

<p>Here‚Äôs a tip: <strong>Don‚Äôt try to solve a problem and engineer a nice solution at the same time.</strong> Testing gives us that opportunity, using this recipe from <a href="https://vimeo.com/68375232">Ian Cooper‚Äôs talk on TDD</a>:</p>

<ol>
  <li>Write a red test.</li>
  <li>Solve the problem, make it green <em>as fast as possible.</em></li>
  <li>Engineer a nice solution, refactor it to something you‚Äôre proud of.</li>
</ol>

<p>The important thing to take away here is the temporal separation of concerns in your head. Do not try to do steps 2 and 3 at the same time. One of the main limitations of programming is how much you can keep in your head at once, and you‚Äôll write better code the less you have to keep there when you‚Äôre typing.</p>

<p>When solving the problem, do not think about how the code really should be. Copy-paste code, write inefficient loops, duplicate stuff, do whatever you have to do to get the test green as fast as possible. <em>Then</em> think about how to change it into something you could show your mother.</p>

<p>Separating your own concerns is one of the reasons to test in the first place, and this method helps doing it in practice. When you quickly and dirtily race to a solution, you don‚Äôt have to think about how it looks or how fast it runs. When you carve out your nicely engineered and cool solution, you don‚Äôt have to worry about screwing something up.</p>

<h2 id="knowing-what-to-test-is-key">Knowing What to Test is Key</h2>

<p>Knowing what to test isn‚Äôt as easy as it sounds, and is definitively something that comes with experience. Many test too much. Knowing what to test is related to understanding what is important, and what isn‚Äôt, and knowing that is not trivial. Here‚Äôs a tip, though:</p>

<blockquote>
  <p><em>Test at the highest level possible to get coverage and flexibility on implementation.</em></p>

  <p>‚Äì Brian Lonsdorf, JavaScript Air 004</p>
</blockquote>

<p>So, basically:</p>

<ol>
  <li><strong>Do not test internal stuff</strong>, it will only get in your way. If you honestly feel like you should test the internal stuff, then you might be better off separating some of the internals out to a new module, where they are external.</li>
  <li>Do not allow tests to be <strong>over specified</strong> and deal with stuff they don‚Äôt have to or shouldn‚Äôt know about.</li>
  <li>Do not write tests just to get 100 % coverage. If someone tells you to always have 100 % coverage, no matter what, then <strong>punch them in the face</strong>.</li>
</ol>

<p>Remember that tests should be written <em>outside-in</em>, from a perspective outside the module. Note that full test coverage should still be possible, i.e. all branches of your code should still be reachable. If they‚Äôre not, they‚Äôre basically dead code, right? <strong>Test the internals only if you need to understand better how they work.</strong></p>

<p>Think about what happens when the code is refactored, some time in the future. The implementation should be allowed to change without tests failing. Why? Well, because <strong>if the future coder has to change the tests, then it‚Äôs basically a rewrite, not a refactor. And rewrites aren‚Äôt safe.</strong> There should be no new tests for refactoring internals.</p>

<p>Be pragmatic about what to test. Testing is part of the project, part of the value creation, and it doesn‚Äôt make sense to test just anything, just like it doesn‚Äôt make sense to implement every button. Remember the documentation aspect. If tests are mostly involved with implementation details, we loose the focus on what‚Äôs <em>important in the module</em>. We loose the documentation value.</p>

<p>About documentation, <strong>test your domain assumptions.</strong> These are the code interpretations of the problem domain you‚Äôre working in, often something where the programmer is not the expert. Documenting these assumptions in code form solves two problems: documenting the assumptions themselves, and proving that they work as interpreted.</p>

<p><strong>Write a test when you find a bug.</strong> Don‚Äôt just fix it, but prove for yourself and others that you‚Äôve actually done so. Write a test, and make sure it‚Äôs both red and aligned what the expectation would be not aware of the bug. Fix the bug, make it green. Save the day.</p>

<p>Code coverage is overrated as a concrete number, but useful as a tool. Do not strive to cover for coverage‚Äôs sake. <strong>Remember that coverage only tells you what lines your tests run, but not in what combination they will run.</strong> However, it can be a good indication of whether things are moving in the right direction. If a refactor leads to poorer code coverage, then some bells should be ringing, especially if it‚Äôs a refactor. Do not allow yourself to write tests just to increase the number. Well tested and written code will have a higher number.</p>

<p><strong>The trigger for writing a test is when you‚Äôve got a new piece of behavior.</strong> The tests should capture that behavior, but no more.</p>

<p>Testing libraries might be both easier and more important than testing end applications. After all, libraries will be used by multiple applications.</p>

<h2 id="how-to-write-awesome-tests">How To Write Awesome Tests</h2>

<p>Knowing how to write good tests is key, because it‚Äôs very easy to write them badly. The truth is, as with everything, that it takes practice. Still, here are some tips.</p>

<p><strong>A good test is a simple test.</strong> It doesn‚Äôt try to cover everything in one go. It‚Äôs name should reflect what it does, and the name should fit comfortably in one line. The name shouldn‚Äôt be <em>‚Äúit works‚Äù</em>, but rather, <em>‚Äúit returns 0 for negative values‚Äù</em></p>

<p><img src="/images/rocket-test.gif" alt="hello" /> <em>A good test is a simple test.</em></p>

<p><strong>Make sure not to overspecify your test.</strong> Overspecified tests know too much about internals for their own good, and don‚Äôt allow refactoring.</p>

<p>A unit test runs the code in isolation from other tests, not necessarily other code. It takes the code out of it‚Äôs context, and creates an artificial context from which an aspect of it can be investigated. However, that does not mean a unit test has to run in isolation from all other <em>code</em>, even though this is often cited as ‚Äúpure unit tests‚Äù. <strong>Everything does not have to be mocked, stubbed or spied on,</strong> leading to more complex setups, lower coverage and more fragile tests.</p>

<p>Use <a href="http://sinonjs.org/docs/#mocks">mocks</a> or <a href="http://sinonjs.org/docs/#stubs">stubs</a> where that makes sense. You don‚Äôt want to test against a real HTTP API, but stub them out. Use a mock or a stub if what you‚Äôre testing is your own call to that object, or if you want to lead your own code down a certain path.</p>

<p><strong>A test should read like a small story, following the AAA system: Arrange, Act, Assert.</strong> You set things up, you make some statement, and you assert that the statement did what the statement should. The ‚Äúsmall story‚Äù aspect has emphasis on <em>small</em>. None of the ‚ÄúA‚Äù-s should be more than about 3 lines. Making some space between the phases can be nice. It should contain no branching or looping, and you should assert only one logical thing. (It‚Äôs nice if that can be expressed as one assert statement, but sometimes you‚Äôll need more, and that‚Äôs OK.) Never assert in two different places in the test, as this causes confusion as to what you‚Äôre actually testing.</p>

<p><strong>The test should be readable with only some domain knowledge.</strong> If it does things that are hard to explain without going into the inner workings of the module, then it‚Äôs probably better to either spend some more time on the test, or just leave it out completely.</p>

<p>Generally, don‚Äôt test your dependencies. For certain projects, it may make sense to do some simple testing of the assumptions your own code is making, but do so sparingly and with caution. Testing a library is the job of the library author. Instead, rely on changelogs for upgrades, and on testing your integration against the library (this is a reason not to mock everything).</p>

<p>Write cheap tests that don‚Äôt take forever to run, because <strong>run them as often as possible</strong>. If you can pass a <code class="highlighter-rouge">--watch</code> argument to your test runner and have it run every time a file is changed, then that‚Äôs a good thing.</p>

<p>Last but not least, <strong>use a test framework you like working with.</strong> If JavaScript is your thing, I‚Äôd like to recommend <a href="https://github.com/sindresorhus/ava">AVA üöÄ</a> because of it‚Äôs clarity, simplicity and lack of complex configuration. Whatever you choose, make sure it‚Äôs something that works with you and helps you write efficiently and fast. As with everything code, if it‚Äôs not fun, something is probably wrong.</p>


          </div>

          

          <hr>

          <div class="share">
              <h4 class="subtitle">Share this post and be extra cool</h4>
              <a class="fa fa-twitter" href="http://twitter.com/share?text=Why and How Testing Can Make You Happier&amp;url=http://mikbe.comcodetestingdx20160311why-and-how-testing-can-make-you-happier.html"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                  <span class="hidden">Twitter</span>
              </a>
              <a class="fa fa-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://mikbe.comcodetestingdx20160311why-and-how-testing-can-make-you-happier.html"
                  onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                  <span class="hidden">Facebook</span>
              </a>
              <a class="fa fa-google-plus" href="https://plus.google.com/share?url=http://mikbe.comcodetestingdx20160311why-and-how-testing-can-make-you-happier.html"
                 onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                  <span class="hidden">Google+</span>
              </a>
          </section>

        </article>
      </div>
    </section>

    <section class="hero is-bold is-info">
      <div class="hero-content">
        <h2>You might also like ...</h2>
        <section class="container">
          <div class="columns">

            
              <div class="column">
                <a class="read-next-story" href="/awesome/projects/2016/02/14/generate-awesome-codenames-with-codenamer.html">
                  <section class="post">
                    <h2 class="title">Give Your Releases Awesome Names with Codenamer</h2>
                    <p>TL;DR: I‚Äôve released Codenamer, a simple CLI to generate codenames. Such as it‚Äôs own release...</p>
                  </section>
                </a>
              </div>
            

            

          </div>
        </div>


      </div>
    </section>

    <footer class="footer">
  <div class="container">
    <h2 class="subtitle">Mikbe.com</h2>

    <div class="columns">

      <!-- Contact List -->
      <div class="column">
        <ul>
          <li>Mikbe.com</li>
          <li><a href="mailto:mikaelbrg@gmail.com">mikaelbrg@gmail.com</a></li>
        </ul>
      </div>

      <!-- Social Media List -->
      <div class="column">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/mikberg"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">mikberg</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/mikaelberg2k"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">mikaelberg2k</span></a>

          </li>
          
        </ul>
      </div>

      <!-- Site Description -->
      <div class="column is-half">
        <p>This is where I publish stuff I think others can find useful.
</p>
      </div>

    </div>
  </div>
</footer>


    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3740312-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
